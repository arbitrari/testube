<div class="dialog-header">
    <h2 mat-dialog-title>Application Settings</h2>
    <div class="header-actions">
        <button mat-button [mat-dialog-close]="true" (click)="onSave()">Save</button>
        <button mat-button mat-dialog-close (click)="onCancel()">Cancel</button>
    </div>
</div>
<mat-dialog-content>
    <mat-tab-group>
        <mat-tab label="Services">
            <div class="tab-content services-tab-content">
                <h3>Region Selection</h3>
                <p>Choose your region to filter available services</p>
                <mat-form-field appearance="outline">
                    <mat-label>Select Region</mat-label>
                    <mat-select [value]="selectedRegion" (selectionChange)="onRegionChange($event.value)" disableOptionCentering>
                        <mat-select-trigger>
                            <span *ngIf="selectedRegion === RegionType.Worldwide">ðŸŒŽ Worldwide</span>
                            <span *ngIf="selectedRegion === RegionType.US"><img class="flag-icon" src="https://flagcdn.com/16x12/us.png" alt="US"> United States</span>
                            <span *ngIf="selectedRegion === RegionType.UK"><img class="flag-icon" src="https://flagcdn.com/16x12/gb.png" alt="GB"> United Kingdom</span>
                            <span *ngIf="selectedRegion === RegionType.Unfiltered">ðŸš« Unfiltered (all regions)</span>
                        </mat-select-trigger>
                        <mat-option [value]="RegionType.Worldwide">ðŸŒŽ Worldwide</mat-option>
                        <mat-option [value]="RegionType.US"><img class="flag-icon" src="https://flagcdn.com/16x12/us.png" alt="US"> United States</mat-option>
                        <mat-option [value]="RegionType.UK"><img class="flag-icon" src="https://flagcdn.com/16x12/gb.png" alt="GB"> United Kingdom</mat-option>
                        <mat-option [value]="RegionType.Unfiltered">ðŸš« Unfiltered (all regions)</mat-option>
                    </mat-select>
                </mat-form-field>

                <h3>Source Visibility</h3>
                <p>Hide sources that are not relevant to you</p>
                <div class="region-controls">
                    <button mat-stroked-button (click)="selectAllForRegion()">Select All</button>
                    <button mat-stroked-button (click)="selectNoneForRegion()">Select None</button>
                </div>
                <div class="source-container">
                  <mat-selection-list #sourceList [multiple]="true">
                    @for (category of getCategories(); track category) {
                      <div class="category-section">
                        <h4 class="category-header">{{getCategoryName(category)}}</h4>
                        @for (pair of getSourcesByCategory(category); track pair[0]) {
                          <mat-list-option [value]="pair[0]" [selected]="!localHiddenSources.has(pair[0])" class="category-item">
                            {{pair[1].name}}
                            <small style="opacity: 0.7; margin-left: 8px;">({{pair[1].region}})</small>
                          </mat-list-option>
                        }
                      </div>
                    }
                  </mat-selection-list>
                </div>
            </div>
        </mat-tab>
        
        <mat-tab label="Preferences">
            <div class="tab-content">
                <h3>Layout Settings</h3>
                <div class="layout-settings">
                    <mat-checkbox [(ngModel)]="horizontalScrolling" color="primary">
                        Horizontal Scrolling
                    </mat-checkbox>
                    <p class="setting-description">
                        When enabled, services scroll horizontally. When disabled, services wrap to new lines.
                    </p>
                </div>

                <h3 class="fullscreen-heading">Fullscreen Settings</h3>
                <div class="fullscreen-settings">
                    <mat-form-field appearance="outline">
                        <mat-label>URL</mat-label>
                        <input matInput [(ngModel)]="fullscreenUrl" placeholder="https://example.com" />
                    </mat-form-field>
                    <p class="setting-description">
                        URL used when opening in fullscreen mode. Defaults to the current site's URL.
                    </p>
                </div>
            </div>
        </mat-tab>
    </mat-tab-group>
</mat-dialog-content>